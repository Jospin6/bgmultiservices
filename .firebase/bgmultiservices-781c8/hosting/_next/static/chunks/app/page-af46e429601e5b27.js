(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{20566:(e,a,t)=>{Promise.resolve().then(t.bind(t,62191))},62191:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>f});var s=t(95155),d=t(12115),r=t(83391),l=t(29009),o=t(76472),n=t(35781);n.t1.register(n.PP,n.kc,n.FN,n.No,n.hE,n.m_,n.s$);let i=()=>{let e=(0,r.wA)(),a=(0,r.d4)(e=>e.sale.salesLast7Days);(0,d.useEffect)(()=>{e((0,l.h8)())},[e]);let t={labels:a?Object.keys(a):[],datasets:[{label:"Ventes (fc)",data:a?Object.values(a):[],borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!0}]};return(0,s.jsx)(o.N1,{data:t})};var c=t(10503),u=t(48173),p=t.n(u),m=t(52587),g=t(94321),h=t(14732),x=t(81654);function f(){let e=(0,r.wA)(),{sales:a,salesCountToday:t,totalSalesCount:o,salesAmountToday:n,totalSalesAmount:u}=(0,r.d4)(e=>e.sale),{totalProductsInStock:f}=(0,r.d4)(e=>e.product),{impressionsAmountCurrentMonth:y,printedPapersCountCurrentMonth:C}=(0,r.d4)(e=>e.impression),{user:b}=(0,r.d4)(e=>e.auth);return((0,d.useEffect)(()=>{e((0,x.Ny)()),e((0,l.ke)()),e((0,l.FQ)()),e((0,l.aK)()),e((0,l.Op)()),e((0,l.RA)()),e((0,m.wG)()),e((0,m.GT)()),e((0,g.Qu)())},[e]),(null==b?void 0:b.name)!="")?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"md:grid md:grid-cols-8 md:gap-4 mt-4",children:[(0,s.jsxs)("div",{className:"md:col-span-2 sm:block shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsxs)("div",{className:"text-2xl font-[500]",children:[" ",null!=t?t:0," "]}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Nbr vente du jour"})]}),(0,s.jsxs)("div",{className:"md:col-span-2 sm:block shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsxs)("div",{className:"text-2xl font-[500]",children:[" ",null!=n?n:0," fc "]}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Montant encais\xe9"})]}),(0,s.jsxs)("div",{className:"md:col-span-2 sm:block shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsxs)("div",{className:"text-2xl font-[500]",children:[null!=y?y:0," fc"]}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Montant impression mois courant"})]}),(0,s.jsxs)("div",{className:"md:col-span-2 sm:block shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsx)("div",{className:"text-2xl font-[500]",children:null!=C?C:0}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Nbr papiers sorties"})]})]}),(0,s.jsxs)("div",{className:"md:grid md:grid-cols-6 sm:block md:gap-4 mt-2",children:[(0,s.jsx)("div",{className:"md:col-span-3 shadow-lg rounded-lg h-auto p-[10px]",children:(0,s.jsx)(i,{})}),(0,s.jsxs)("div",{className:"md:col-span-3 h-auto",children:[(0,s.jsxs)("div",{className:"shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsx)("div",{className:"text-2xl font-[500]",children:null!=f?f:0}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Nbr produits en stock"})]}),(0,s.jsxs)("div",{className:"shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsx)("div",{className:"text-2xl font-[500]",children:null!=o?o:0}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Nbr total des ventes"})]}),(0,s.jsxs)("div",{className:"shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsxs)("div",{className:"text-2xl font-[500]",children:[null!=u?u:0," fc"]}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Tot montant ventes"})]})]})]}),(0,s.jsx)("div",{className:"text-xl py-4",children:"les 10 derniers ventes"}),(0,s.jsxs)("table",{className:"w-full text-center table-auto sm:table-fixed",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b-[1px] border-gray-300",children:[(0,s.jsx)("th",{children:"Date"}),(0,s.jsx)("th",{children:"Articles"}),(0,s.jsx)("th",{children:"Prix total"}),(0,s.jsx)("th",{children:"Actions"})]})}),(0,s.jsx)("tbody",{children:a&&a.length>0?a.map(e=>(0,s.jsxs)("tr",{className:"border-b-[1px] border-gray-300",children:[(0,s.jsxs)("td",{className:"w-1/3",children:[" ",(0,h.l)(e.date)," "]}),(0,s.jsx)("td",{className:"w-1/3",children:e.articles.map((e,a)=>(0,s.jsxs)("span",{children:[" nom: ",e.nom,", qt\xe9: ",e.quantite,", prixTot ",e.prix," fc "]},a))}),(0,s.jsxs)("td",{className:"w-1/3",children:[" ",e.total," fc "]}),(0,s.jsxs)("td",{className:"flex justify-center w-1/3",children:[" ",(0,s.jsx)(p(),{href:"/sales",children:(0,s.jsx)(c.A,{size:20})})]})]},e.id)):(0,s.jsx)("tr",{className:"border-b-[1px] border-gray-300",children:(0,s.jsx)("td",{colSpan:4,children:"Pas de ventes enregistr\xe9es"})})})]})]}):(0,s.jsxs)("div",{className:"text-center mt-4",children:[(0,s.jsx)("p",{className:"text-2xl",children:"Bienvenue sur LgMultiServices"}),(0,s.jsxs)("p",{className:"text-xl",children:[(0,s.jsx)(p(),{href:"/connexion",className:"text-blue-500",children:"Connectez-vous"})," pour acc\xe9der \xe0 votre compte"]})]})}},81654:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>x,Lx:()=>l,Ny:()=>g,hG:()=>u,hU:()=>n,kg:()=>o,ri:()=>m});var s=t(48943),d=t(75033),r=t(27058);let l=(0,s.zD)("auth/loginUser",async e=>{let{name:a,password:t}=e,s=(0,r.rJ)(d.db,"users"),l=(0,r.P)(s,(0,r._M)("name","==",a),(0,r._M)("password","==",t)),o=await (0,r.GG)(l);if(!o.empty){let e=o.docs[0].id,a=(0,r.H9)(d.db,"users",e),t=await (0,r.x7)(a),s=t.data();if(s)return localStorage.setItem("id",t.id),localStorage.setItem("name",s.name),localStorage.setItem("role",s.role),{name:s.name,id:t.id,role:s.role}}throw Error("Identifiants incorrects")}),o=(0,s.zD)("auth/createUser",async e=>{let a=(0,r.rJ)(d.db,"users"),t=await (0,r.gS)(a,e);return{...e,id:t.id}}),n=(0,s.zD)("auth/fetchUsers",async()=>{let e=(0,r.rJ)(d.db,"users");return(await (0,r.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}),i=(0,s.zD)("auth/fetchUserById",async e=>{let a=(0,r.H9)(d.db,"users",e),t=await (0,r.x7)(a);if(t.exists())return{id:t.id,...t.data()};throw Error("Utilisateur non trouv\xe9")}),c=(0,s.zD)("auth/updateUser",async e=>{if(!e.id)throw Error("User ID is required");let a=(0,r.H9)(d.db,"users",e.id),{id:t,...s}=e;return await (0,r.mZ)(a,s),e}),u=(0,s.zD)("auth/deleteUser",async e=>{let a=(0,r.H9)(d.db,"users",e);return await (0,r.kd)(a),e}),p=(0,s.Z0)({name:"auth",initialState:{user:null,users:[]},reducers:{logout:e=>{e.user=null,localStorage.removeItem("id"),localStorage.removeItem("name"),localStorage.removeItem("role")},currentUser:e=>{e.user={id:localStorage.getItem("id")||"",name:localStorage.getItem("name")||"",role:localStorage.getItem("role")||""}},checkUser:e=>{let a=localStorage.getItem("id"),t=localStorage.getItem("name"),s=localStorage.getItem("role");a&&t&&s?e.user={id:a,name:t,role:s}:e.user=null}},extraReducers:e=>{e.addCase(l.fulfilled,(e,a)=>{e.user=a.payload}).addCase(n.fulfilled,(e,a)=>{e.users=a.payload}).addCase(i.fulfilled,(e,a)=>{e.users.find(e=>e.id===a.payload.id)||e.users.push(a.payload)}).addCase(o.fulfilled,(e,a)=>{e.users.push(a.payload)}).addCase(c.fulfilled,(e,a)=>{let t=e.users.findIndex(e=>e.id===a.payload.id);-1!==t&&(e.users[t]=a.payload)}).addCase(u.fulfilled,(e,a)=>{e.users=e.users.filter(e=>e.id!==a.payload)})}}),{logout:m,currentUser:g,checkUser:h}=p.actions,x=p.reducer},52587:(e,a,t)=>{"use strict";t.d(a,{$y:()=>i,Ay:()=>m,GT:()=>p,Xv:()=>n,dd:()=>c,wG:()=>u});var s=t(48943),d=t(27058),r=t(75033),l=t(21455),o=t.n(l);let n=(0,s.zD)("impression/addImpression",async e=>({id:(await (0,d.gS)((0,d.rJ)(r.db,"impressions"),e)).id,...e})),i=(0,s.zD)("impression/fetchImpressions",async()=>(await (0,d.GG)((0,d.rJ)(r.db,"impressions"))).docs.map(e=>({id:e.id,...e.data()}))),c=(0,s.zD)("impression/deleteImpression",async e=>(await (0,d.kd)((0,d.H9)(r.db,"impressions",e)),e)),u=(0,s.zD)("impression/amountCurrentMonth",async()=>{let e=o()().startOf("month").format("YYYY-MM"),a=(0,d.rJ)(r.db,"impressions"),t=(0,d.P)(a,(0,d._M)("date",">=",e)),s=await (0,d.GG)(t),l=0;return s.docs.forEach(e=>{l+=e.data().amount||0}),l}),p=(0,s.zD)("impression/papersCountCurrentMonth",async()=>{let e=o()().startOf("month").format("YYYY-MM"),a=(0,d.rJ)(r.db,"impressions"),t=(0,d.P)(a,(0,d._M)("date",">=",e)),s=await (0,d.GG)(t),l=0;return s.docs.forEach(e=>{l+=e.data().totalPapers||0}),l}),m=(0,s.Z0)({name:"impression",initialState:{loading:!1,impression:null,error:"",impressionsAmountCurrentMonth:0,printedPapersCountCurrentMonth:0},reducers:{},extraReducers:e=>{e.addCase(i.pending,e=>{e.loading=!0}),e.addCase(i.fulfilled,(e,a)=>{e.loading=!1,e.impression=a.payload}),e.addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.payload||"An error occurred"}),e.addCase(n.fulfilled,(e,a)=>{e.impression=e.impression?[...e.impression,a.payload]:[a.payload]}),e.addCase(c.fulfilled,(e,a)=>{e.impression&&(e.impression=e.impression.filter(e=>e.id!==a.payload))}),e.addCase(u.fulfilled,(e,a)=>{e.impressionsAmountCurrentMonth=a.payload}),e.addCase(p.fulfilled,(e,a)=>{e.printedPapersCountCurrentMonth=a.payload})}}).reducer},94321:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>u,Bj:()=>l,DD:()=>i,Qu:()=>c,j0:()=>o,vc:()=>n});var s=t(48943),d=t(27058),r=t(75033);let l=(0,s.zD)("product/addProduct",async e=>({id:(await (0,d.gS)((0,d.rJ)(r.db,"products"),e)).id,...e})),o=(0,s.zD)("product/fetchProducts",async()=>(await (0,d.GG)((0,d.rJ)(r.db,"products"))).docs.map(e=>({id:e.id,...e.data()}))),n=(0,s.zD)("product/updateProduct",async e=>{let{id:a,newStock:t}=e,s=(0,d.H9)(r.db,"products",a);return await (0,d.mZ)(s,{stock:t}),{id:a,newStock:t}}),i=(0,s.zD)("product/deleteProduct",async e=>(await (0,d.kd)((0,d.H9)(r.db,"products",e)),e)),c=(0,s.zD)("product/totalStock",async()=>{let e=(0,d.rJ)(r.db,"products"),a=await (0,d.GG)(e),t=0;return a.docs.forEach(e=>{t+=e.data().stock||0}),t}),u=(0,s.Z0)({name:"product",initialState:{loading:!1,products:null,error:"",totalProductsInStock:0},reducers:{},extraReducers:e=>{e.addCase(o.pending,e=>{e.loading=!0}),e.addCase(o.fulfilled,(e,a)=>{e.loading=!1,e.products=a.payload}),e.addCase(o.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}),e.addCase(l.fulfilled,(e,a)=>{e.products=e.products?[...e.products,a.payload]:[a.payload]}),e.addCase(n.fulfilled,(e,a)=>{e.products&&(e.products=e.products.map(e=>e.id===a.payload.id?{...e,stock:a.payload.newStock}:e))}),e.addCase(i.fulfilled,(e,a)=>{e.products&&(e.products=e.products.filter(e=>e.id!==a.payload))}),e.addCase(c.fulfilled,(e,a)=>{e.totalProductsInStock=a.payload})}}).reducer},29009:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>f,FQ:()=>c,Op:()=>p,RA:()=>m,Vf:()=>l,aK:()=>u,dS:()=>i,h8:()=>h,j3:()=>o,ke:()=>g});var s=t(48943),d=t(27058),r=t(75033);let l=(0,s.zD)("sale/addSale",async e=>{try{let a=await (0,d.gS)((0,d.rJ)(r.db,"sales"),e);console.log("Vente ajout\xe9 avec ID :",a.id)}catch(e){console.error("Erreur lors de l'ajout :",e)}}),o=(0,s.zD)("sale/fetchSales",async()=>{try{let e=(await (0,d.GG)((0,d.rJ)(r.db,"sales"))).docs.map(e=>({id:e.id,...e.data()}));return console.log("ventes r\xe9cup\xe9r\xe9s :",e),e}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration :",e)}}),n=(0,s.zD)("sale/updateSale",async(e,a)=>{try{let t=(0,d.H9)(r.db,"sales",e);await (0,d.mZ)(t,a),console.log("Vente mis \xe0 jour !")}catch(e){console.error("Erreur lors de la mise \xe0 jour :",e)}}),i=(0,s.zD)("sale/deleteSale",async e=>{try{await (0,d.kd)((0,d.H9)(r.db,"sales",e)),console.log("Vente supprim\xe9 !")}catch(e){console.error("Erreur lors de la suppression :",e)}}),c=(0,s.zD)("sale/fetchSalesCountToday",async()=>{let e=new Date,a=e.getUTCFullYear(),t=String(e.getUTCMonth()+1).padStart(2,"0"),s=String(e.getUTCDate()).padStart(2,"0"),l="".concat(a,"-").concat(t,"-").concat(s,"T00:00:00.000Z"),o=(0,d.rJ)(r.db,"sales"),n=(0,d.P)(o,(0,d._M)("date","==",l));return(await (0,d.GG)(n)).docs.length}),u=(0,s.zD)("sale/fetchTotalSalesCount",async()=>{let e=(0,d.rJ)(r.db,"sales");return(await (0,d.GG)(e)).docs.length}),p=(0,s.zD)("sale/amountToday",async()=>{let e=new Date,a=e.getUTCFullYear(),t=String(e.getUTCMonth()+1).padStart(2,"0"),s=String(e.getUTCDate()).padStart(2,"0"),l="".concat(a,"-").concat(t,"-").concat(s,"T00:00:00.000Z"),o=(0,d.rJ)(r.db,"sales"),n=(0,d.P)(o,(0,d._M)("date","==",l)),i=await (0,d.GG)(n),c=0;return i.docs.forEach(e=>{let a=e.data();c+=a.total}),c}),m=(0,s.zD)("sale/totalAmount",async()=>{let e=(0,d.rJ)(r.db,"sales"),a=await (0,d.GG)(e),t=0;return a.docs.forEach(e=>{let a=e.data();t+=a.total}),t}),g=(0,s.zD)("sale/last10",async()=>{let e=(0,d.rJ)(r.db,"sales"),a=(0,d.P)(e,(0,d.My)("date","desc"),(0,d.AB)(10));return(await (0,d.GG)(a)).docs.map(e=>({id:e.id,...e.data()}))}),h=(0,s.zD)("sale/last7Days",async()=>{let e=new Date,a=new Date;a.setDate(e.getDate()-7),a.setHours(0,0,0,0);let t="".concat(a.getUTCFullYear(),"-").concat(String(a.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(a.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z"),s=(0,d.rJ)(r.db,"sales"),l=(0,d.P)(s,(0,d._M)("date",">=",t)),o=await (0,d.GG)(l),n={};for(let a=6;a>=0;a--){let t=new Date;t.setDate(e.getDate()-a),n["".concat(t.getUTCFullYear(),"-").concat(String(t.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(t.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z").split("T")[0]]=0}return o.docs.forEach(e=>{let a=e.data(),t=new Date(a.date),s="".concat(t.getUTCFullYear(),"-").concat(String(t.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(t.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z").split("T")[0];n.hasOwnProperty(s)&&(n[s]+=a.total)}),n}),x=(0,s.zD)("sale/byProduct",async()=>{let e=(0,d.rJ)(r.db,"sales"),a=await (0,d.GG)(e),t={};return a.docs.forEach(e=>{e.data().articles.forEach(e=>{t[e.nom]||(t[e.nom]=0),t[e.nom]+=e.total})}),t}),f=(0,s.Z0)({name:"sale",initialState:{loading:!1,salesLast7Days:[],sales:null,error:"",salesByProduct:[],salesCountToday:0,totalSalesCount:0,salesAmountToday:0,totalSalesAmount:0},reducers:{},extraReducers:e=>{e.addCase(l.pending,e=>{e.loading=!0}).addCase(l.fulfilled,e=>{e.loading=!1}).addCase(l.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(o.pending,e=>{e.loading=!0}).addCase(o.fulfilled,(e,a)=>{e.loading=!1,e.sales=a.payload}).addCase(o.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(n.pending,e=>{e.loading=!0}).addCase(n.fulfilled,e=>{e.loading=!1}).addCase(n.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.loading=!0}).addCase(i.fulfilled,e=>{e.loading=!1}).addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(c.fulfilled,(e,a)=>{e.salesCountToday=a.payload}).addCase(u.fulfilled,(e,a)=>{e.totalSalesCount=a.payload}).addCase(p.fulfilled,(e,a)=>{e.salesAmountToday=a.payload}).addCase(m.fulfilled,(e,a)=>{e.totalSalesAmount=a.payload}).addCase(g.fulfilled,(e,a)=>{e.sales=a.payload}).addCase(h.fulfilled,(e,a)=>{e.salesLast7Days=a.payload}).addCase(x.fulfilled,(e,a)=>{e.salesByProduct=a.payload})}}).reducer},14732:(e,a,t)=>{"use strict";t.d(a,{l:()=>s});let s=e=>{let a=new Date(e),t=String(a.getUTCDate()).padStart(2,"0"),s=String(a.getUTCMonth()+1).padStart(2,"0"),d=a.getUTCFullYear();return"".concat(t," ").concat(s," ").concat(d)}},75033:(e,a,t)=>{"use strict";t.d(a,{db:()=>l});var s=t(49904),d=t(27058);let r=(0,s.Wp)({apiKey:"AIzaSyASZSWBGwPJYuQDRi1GObaNtrccuaBfu70",authDomain:"bgmultiservices-781c8.firebaseapp.com",projectId:"bgmultiservices-781c8",messagingSenderId:"749311417727",appId:"1:749311417727:web:3ea8698ba8ac3ac7ac8e4a"}),l=(0,d.aU)(r)}},e=>{var a=a=>e(e.s=a);e.O(0,[992,647,876,125,927,441,517,358],()=>a(20566)),_N_E=e.O()}]);