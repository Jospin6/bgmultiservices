(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{20566:(e,s,l)=>{Promise.resolve().then(l.bind(l,62191))},62191:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>k});var a=l(95155),r=l(12115),t=l(83391),d=l(29009),i=l(76472),n=l(35781);n.t1.register(n.PP,n.kc,n.FN,n.No,n.hE,n.m_,n.s$);let o=()=>{let e=(0,t.wA)(),s=(0,t.d4)(e=>e.sale.salesLast7Days);(0,r.useEffect)(()=>{e((0,d.h8)())},[e]);let l={labels:s?Object.keys(s):[],datasets:[{label:"Ventes (fc)",data:s?Object.values(s):[],borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!0}]};return(0,a.jsx)(i.N1,{data:l})};var c=l(3100),u=l(301),m=l(11089),x=l(41983),h=l(39536),p=l(40336),j=l(76398),g=l(10503),b=l(48173),f=l.n(b),N=l(52587),v=l(94321),y=l(14732),w=l(81654),I=l(99500);function k(){let e=(0,t.wA)(),{sales:s,salesCountToday:l,totalSalesCount:i,salesAmountToday:n,totalSalesAmount:b}=(0,t.d4)(e=>e.sale),{totalProductsInStock:k}=(0,t.d4)(e=>e.product),{impressionsAmountCurrentMonth:S,printedPapersCountCurrentMonth:z}=(0,t.d4)(e=>e.impression),{user:A}=(0,t.d4)(e=>e.auth);return((0,r.useEffect)(()=>{e((0,w.Ny)()),e((0,d.ke)()),e((0,d.FQ)()),e((0,d.aK)()),e((0,d.Op)()),e((0,d.RA)()),e((0,N.wG)()),e((0,N.GT)()),e((0,v.Qu)())},[e]),(null==A?void 0:A.name)!="")?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"md:grid md:grid-cols-8 md:gap-4 mt-4",children:[((null==A?void 0:A.role)==="admin"||(null==A?void 0:A.role)==="caissier")&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.o,{title:"".concat(null!=l?l:0),subTitle:"Nbr vente du jour",Icon:(0,a.jsx)(c.A,{size:30,className:"text-indigo-500"}),className:"md:col-span-2"}),(0,a.jsx)(I.o,{title:"".concat(null!=n?n:0," fc"),subTitle:"Montant encais\xe9",Icon:(0,a.jsx)(u.A,{size:30,className:"text-emerald-500"}),className:"md:col-span-2"})]}),((null==A?void 0:A.role)==="admin"||(null==A?void 0:A.role)==="impression")&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.o,{title:"".concat(null!=S?S:0," fc"),subTitle:"Montant impression",Icon:(0,a.jsx)(m.A,{size:30,className:"text-pink-500"}),className:"md:col-span-2"}),(0,a.jsx)(I.o,{title:"".concat(null!=z?z:0),subTitle:"Nbr papiers sorties",Icon:(0,a.jsx)(x.A,{size:30,className:"text-sky-500"}),className:"md:col-span-2"})]})]}),(0,a.jsxs)("div",{className:"md:grid md:grid-cols-6 sm:block md:gap-4 mt-2",children:[((null==A?void 0:A.role)==="admin"||(null==A?void 0:A.role)==="caissier")&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"md:col-span-3 shadow-lg rounded-lg h-auto p-[10px]",children:(0,a.jsx)(o,{})})}),(0,a.jsxs)("div",{className:"md:col-span-3 h-auto",children:[((null==A?void 0:A.role)==="admin"||(null==A?void 0:A.role)==="caissier")&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.o,{title:"".concat(null!=k?k:0),subTitle:"Nbr produits en stock",Icon:(0,a.jsx)(h.A,{size:30,className:"text-yellow-500"}),className:"md:col-span-2"}),(0,a.jsx)(I.o,{title:"".concat(null!=i?i:0),subTitle:"Nbr total des ventes",Icon:(0,a.jsx)(p.A,{size:30,className:"text-rose-500"}),className:"md:col-span-2"})]}),(null==A?void 0:A.role)==="admin"&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(I.o,{title:"".concat(b+S," fc"),subTitle:"Montant Total",Icon:(0,a.jsx)(j.A,{size:30,className:"text-teal-500"}),className:"md:col-span-2"})})]})]}),((null==A?void 0:A.role)==="admin"||(null==A?void 0:A.role)==="caissier")&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"md:text-xl text-[14px] py-4 flex justify-between",children:[(0,a.jsx)("span",{children:"les 10 derniers ventes"}),(null==A?void 0:A.role)=="admin"&&(0,a.jsx)(f(),{href:"/rapports",className:"text-blue-700",children:"Voir les rapports"})]}),(0,a.jsxs)("table",{className:"w-full text-center table-auto sm:table-fixed border-collapse border border-gray-300",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b-[1px] border-gray-300",children:[(0,a.jsx)("th",{children:"Date"}),(0,a.jsx)("th",{children:"Articles"}),(0,a.jsx)("th",{children:"Prix total"}),(0,a.jsx)("th",{children:"Encod\xe9 par"}),(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsx)("tbody",{children:s&&s.length>0?s.map(e=>(0,a.jsxs)("tr",{className:"border-[1px] border-gray-300",children:[(0,a.jsxs)("td",{className:"w-1/3",children:[" ",(0,y.l)(e.date)," "]}),(0,a.jsx)("td",{className:"w-1/3",children:e.articles.map((e,s)=>(0,a.jsxs)("span",{children:["nom: ",e.nom,", qt\xe9: ",e.quantite,", prixTot ",e.prix," fc"]},s))}),(0,a.jsxs)("td",{className:"w-1/3",children:[" ",e.total," fc "]}),(0,a.jsxs)("td",{className:"w-1/3",children:[" ",e.user," "]}),(0,a.jsx)("td",{className:"flex justify-center w-1/3",children:(0,a.jsx)(f(),{href:"/sales",children:(0,a.jsx)(g.A,{size:20})})})]},e.id)):(0,a.jsx)("tr",{className:"border-b-[1px] border-gray-300",children:(0,a.jsx)("td",{colSpan:4,children:"Pas de ventes enregistr\xe9es"})})})]})]})]}):(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",style:{backgroundImage:"url('/images/bg.jpg')",backgroundSize:"cover",backgroundPosition:"center"},children:(0,a.jsxs)("p",{className:"text-2xl text-white",children:[(0,a.jsx)("span",{className:"block mb-4",children:"Bienvenue sur LgMultiServices"}),(0,a.jsx)(f(),{href:"/connexion",className:"text-blue-100 p-2 my-2 rounded-lg bg-blue-600",children:"Connectez-vous"}),(0,a.jsx)("span",{className:"block mt-4",children:"pour acc\xe9der \xe0 votre compte"})]})})}},81654:(e,s,l)=>{"use strict";l.d(s,{Ay:()=>j,Lx:()=>d,Ny:()=>h,hG:()=>u,hU:()=>n,kg:()=>i,ri:()=>x});var a=l(48943),r=l(75033),t=l(27058);let d=(0,a.zD)("auth/loginUser",async e=>{let{name:s,password:l}=e,a=(0,t.rJ)(r.db,"users"),d=(0,t.P)(a,(0,t._M)("name","==",s),(0,t._M)("password","==",l)),i=await (0,t.GG)(d);if(!i.empty){let e=i.docs[0].id,s=(0,t.H9)(r.db,"users",e),l=await (0,t.x7)(s),a=l.data();if(a)return localStorage.setItem("id",l.id),localStorage.setItem("name",a.name),localStorage.setItem("role",a.role),{name:a.name,id:l.id,role:a.role}}throw Error("Identifiants incorrects")}),i=(0,a.zD)("auth/createUser",async e=>{let s=(0,t.rJ)(r.db,"users"),l=await (0,t.gS)(s,e);return{...e,id:l.id}}),n=(0,a.zD)("auth/fetchUsers",async()=>{let e=(0,t.rJ)(r.db,"users");return(await (0,t.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}),o=(0,a.zD)("auth/fetchUserById",async e=>{let s=(0,t.H9)(r.db,"users",e),l=await (0,t.x7)(s);if(l.exists())return{id:l.id,...l.data()};throw Error("Utilisateur non trouv\xe9")}),c=(0,a.zD)("auth/updateUser",async e=>{if(!e.id)throw Error("User ID is required");let s=(0,t.H9)(r.db,"users",e.id),{id:l,...a}=e;return await (0,t.mZ)(s,a),e}),u=(0,a.zD)("auth/deleteUser",async e=>{let s=(0,t.H9)(r.db,"users",e);return await (0,t.kd)(s),e}),m=(0,a.Z0)({name:"auth",initialState:{user:null,users:[]},reducers:{logout:e=>{e.user=null,localStorage.removeItem("id"),localStorage.removeItem("name"),localStorage.removeItem("role")},currentUser:e=>{e.user={id:localStorage.getItem("id")||"",name:localStorage.getItem("name")||"",role:localStorage.getItem("role")||""}},checkUser:e=>{let s=localStorage.getItem("id"),l=localStorage.getItem("name"),a=localStorage.getItem("role");s&&l&&a?e.user={id:s,name:l,role:a}:e.user=null}},extraReducers:e=>{e.addCase(d.fulfilled,(e,s)=>{e.user=s.payload}).addCase(n.fulfilled,(e,s)=>{e.users=s.payload}).addCase(o.fulfilled,(e,s)=>{e.users.find(e=>e.id===s.payload.id)||e.users.push(s.payload)}).addCase(i.fulfilled,(e,s)=>{e.users.push(s.payload)}).addCase(c.fulfilled,(e,s)=>{let l=e.users.findIndex(e=>e.id===s.payload.id);-1!==l&&(e.users[l]=s.payload)}).addCase(u.fulfilled,(e,s)=>{e.users=e.users.filter(e=>e.id!==s.payload)})}}),{logout:x,currentUser:h,checkUser:p}=m.actions,j=m.reducer}},e=>{var s=s=>e(e.s=s);e.O(0,[992,647,876,125,775,349,441,517,358],()=>s(20566)),_N_E=e.O()}]);