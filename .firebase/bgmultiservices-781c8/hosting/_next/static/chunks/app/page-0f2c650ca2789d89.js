(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{20566:(a,e,t)=>{Promise.resolve().then(t.bind(t,62191))},62191:(a,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>h});var s=t(95155),d=t(12115),l=t(83391),r=t(29009),o=t(76472),n=t(35781);n.t1.register(n.PP,n.kc,n.FN,n.No,n.hE,n.m_,n.s$);let c=()=>{let a=(0,l.wA)(),e=(0,l.d4)(a=>a.sale.salesLast7Days);(0,d.useEffect)(()=>{a((0,r.h8)())},[a]);let t={labels:e?Object.keys(e):[],datasets:[{label:"Ventes (fc)",data:e?Object.values(e):[],borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!0}]};return(0,s.jsx)(o.N1,{data:t})};var i=t(10503),p=t(48173),u=t.n(p),m=t(52587),g=t(94321),x=t(14732);function h(){let a=(0,l.wA)(),{sales:e,salesCountToday:t,totalSalesCount:o,salesAmountToday:n,totalSalesAmount:p}=(0,l.d4)(a=>a.sale),{totalProductsInStock:h}=(0,l.d4)(a=>a.product),{impressionsAmountCurrentMonth:f,printedPapersCountCurrentMonth:y}=(0,l.d4)(a=>a.impression);return(0,d.useEffect)(()=>{a((0,r.ke)()),a((0,r.FQ)()),a((0,r.aK)()),a((0,r.Op)()),a((0,r.RA)()),a((0,m.wG)()),a((0,m.GT)()),a((0,g.Qu)())},[a]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"md:grid md:grid-cols-8 md:gap-4 mt-4",children:[(0,s.jsxs)("div",{className:"md:col-span-2 sm:block shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsxs)("div",{className:"text-2xl font-[500]",children:[" ",null!=t?t:0," "]}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Nbr vente du jour"})]}),(0,s.jsxs)("div",{className:"md:col-span-2 sm:block shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsxs)("div",{className:"text-2xl font-[500]",children:[" ",null!=n?n:0," fc "]}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Montant encais\xe9"})]}),(0,s.jsxs)("div",{className:"md:col-span-2 sm:block shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsxs)("div",{className:"text-2xl font-[500]",children:[null!=f?f:0," fc"]}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Montant impression mois courant"})]}),(0,s.jsxs)("div",{className:"md:col-span-2 sm:block shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsx)("div",{className:"text-2xl font-[500]",children:null!=y?y:0}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Nbr papiers sorties"})]})]}),(0,s.jsxs)("div",{className:"md:grid md:grid-cols-6 sm:block md:gap-4 mt-2",children:[(0,s.jsx)("div",{className:"md:col-span-3 shadow-lg rounded-lg h-auto p-[10px]",children:(0,s.jsx)(c,{})}),(0,s.jsxs)("div",{className:"md:col-span-3 h-auto",children:[(0,s.jsxs)("div",{className:"shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsx)("div",{className:"text-2xl font-[500]",children:null!=h?h:0}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Nbr produits en stock"})]}),(0,s.jsxs)("div",{className:"shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsx)("div",{className:"text-2xl font-[500]",children:null!=o?o:0}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Nbr total des ventes"})]}),(0,s.jsxs)("div",{className:"shadow-lg rounded-lg h-[100px] p-[10px]",children:[(0,s.jsxs)("div",{className:"text-2xl font-[500]",children:[null!=p?p:0," fc"]}),(0,s.jsx)("div",{className:"text-[14px] text-gray-400",children:"Tot montant ventes"})]})]})]}),(0,s.jsx)("div",{className:"text-xl py-4",children:"les 10 derniers ventes"}),(0,s.jsxs)("table",{className:"w-full text-center table-auto sm:table-fixed",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b-[1px] border-gray-300",children:[(0,s.jsx)("th",{children:"Date"}),(0,s.jsx)("th",{children:"Articles"}),(0,s.jsx)("th",{children:"Prix total"}),(0,s.jsx)("th",{children:"Actions"})]})}),(0,s.jsx)("tbody",{children:e&&e.length>0?e.map(a=>(0,s.jsxs)("tr",{className:"border-b-[1px] border-gray-300",children:[(0,s.jsxs)("td",{className:"w-1/3",children:[" ",(0,x.l)(a.date)," "]}),(0,s.jsx)("td",{className:"w-1/3",children:a.articles.map((a,e)=>(0,s.jsxs)("span",{children:[" nom: ",a.nom,", qt\xe9: ",a.quantite,", prixTot ",a.prix," fc "]},e))}),(0,s.jsxs)("td",{className:"w-1/3",children:[" ",a.total," fc "]}),(0,s.jsxs)("td",{className:"flex justify-center w-1/3",children:[" ",(0,s.jsx)(u(),{href:"/sales",children:(0,s.jsx)(i.A,{size:20})})]})]},a.id)):(0,s.jsx)("tr",{className:"border-b-[1px] border-gray-300",children:(0,s.jsx)("td",{colSpan:4,children:"Pas de ventes enregistr\xe9es"})})})]})]})}},52587:(a,e,t)=>{"use strict";t.d(e,{$y:()=>c,Ay:()=>m,GT:()=>u,Xv:()=>n,dd:()=>i,wG:()=>p});var s=t(48943),d=t(27058),l=t(75033),r=t(21455),o=t.n(r);let n=(0,s.zD)("impression/addImpression",async a=>({id:(await (0,d.gS)((0,d.rJ)(l.db,"impressions"),a)).id,...a})),c=(0,s.zD)("impression/fetchImpressions",async()=>(await (0,d.GG)((0,d.rJ)(l.db,"impressions"))).docs.map(a=>({id:a.id,...a.data()}))),i=(0,s.zD)("impression/deleteImpression",async a=>(await (0,d.kd)((0,d.H9)(l.db,"impressions",a)),a)),p=(0,s.zD)("impression/amountCurrentMonth",async()=>{let a=o()().startOf("month").format("YYYY-MM"),e=(0,d.rJ)(l.db,"impressions"),t=(0,d.P)(e,(0,d._M)("date",">=",a)),s=await (0,d.GG)(t),r=0;return s.docs.forEach(a=>{r+=a.data().amount||0}),r}),u=(0,s.zD)("impression/papersCountCurrentMonth",async()=>{let a=o()().startOf("month").format("YYYY-MM"),e=(0,d.rJ)(l.db,"impressions"),t=(0,d.P)(e,(0,d._M)("date",">=",a)),s=await (0,d.GG)(t),r=0;return s.docs.forEach(a=>{r+=a.data().totalPapers||0}),r}),m=(0,s.Z0)({name:"impression",initialState:{loading:!1,impression:null,error:"",impressionsAmountCurrentMonth:0,printedPapersCountCurrentMonth:0},reducers:{},extraReducers:a=>{a.addCase(c.pending,a=>{a.loading=!0}),a.addCase(c.fulfilled,(a,e)=>{a.loading=!1,a.impression=e.payload}),a.addCase(c.rejected,(a,e)=>{a.loading=!1,a.error=e.payload||"An error occurred"}),a.addCase(n.fulfilled,(a,e)=>{a.impression=a.impression?[...a.impression,e.payload]:[e.payload]}),a.addCase(i.fulfilled,(a,e)=>{a.impression&&(a.impression=a.impression.filter(a=>a.id!==e.payload))}),a.addCase(p.fulfilled,(a,e)=>{a.impressionsAmountCurrentMonth=e.payload}),a.addCase(u.fulfilled,(a,e)=>{a.printedPapersCountCurrentMonth=e.payload})}}).reducer},94321:(a,e,t)=>{"use strict";t.d(e,{Ay:()=>p,Bj:()=>r,DD:()=>c,Qu:()=>i,j0:()=>o,vc:()=>n});var s=t(48943),d=t(27058),l=t(75033);let r=(0,s.zD)("product/addProduct",async a=>({id:(await (0,d.gS)((0,d.rJ)(l.db,"products"),a)).id,...a})),o=(0,s.zD)("product/fetchProducts",async()=>(await (0,d.GG)((0,d.rJ)(l.db,"products"))).docs.map(a=>({id:a.id,...a.data()}))),n=(0,s.zD)("product/updateProduct",async a=>{let{id:e,newStock:t}=a,s=(0,d.H9)(l.db,"products",e);return await (0,d.mZ)(s,{stock:t}),{id:e,newStock:t}}),c=(0,s.zD)("product/deleteProduct",async a=>(await (0,d.kd)((0,d.H9)(l.db,"products",a)),a)),i=(0,s.zD)("product/totalStock",async()=>{let a=(0,d.rJ)(l.db,"products"),e=await (0,d.GG)(a),t=0;return e.docs.forEach(a=>{t+=a.data().stock||0}),t}),p=(0,s.Z0)({name:"product",initialState:{loading:!1,products:null,error:"",totalProductsInStock:0},reducers:{},extraReducers:a=>{a.addCase(o.pending,a=>{a.loading=!0}),a.addCase(o.fulfilled,(a,e)=>{a.loading=!1,a.products=e.payload}),a.addCase(o.rejected,(a,e)=>{a.loading=!1,a.error=e.payload}),a.addCase(r.fulfilled,(a,e)=>{a.products=a.products?[...a.products,e.payload]:[e.payload]}),a.addCase(n.fulfilled,(a,e)=>{a.products&&(a.products=a.products.map(a=>a.id===e.payload.id?{...a,stock:e.payload.newStock}:a))}),a.addCase(c.fulfilled,(a,e)=>{a.products&&(a.products=a.products.filter(a=>a.id!==e.payload))}),a.addCase(i.fulfilled,(a,e)=>{a.totalProductsInStock=e.payload})}}).reducer},29009:(a,e,t)=>{"use strict";t.d(e,{Ay:()=>f,FQ:()=>i,Op:()=>u,RA:()=>m,Vf:()=>r,aK:()=>p,dS:()=>c,h8:()=>x,j3:()=>o,ke:()=>g});var s=t(48943),d=t(27058),l=t(75033);let r=(0,s.zD)("sale/addSale",async a=>{try{let e=await (0,d.gS)((0,d.rJ)(l.db,"sales"),a);console.log("Vente ajout\xe9 avec ID :",e.id)}catch(a){console.error("Erreur lors de l'ajout :",a)}}),o=(0,s.zD)("sale/fetchSales",async()=>{try{let a=(await (0,d.GG)((0,d.rJ)(l.db,"sales"))).docs.map(a=>({id:a.id,...a.data()}));return console.log("ventes r\xe9cup\xe9r\xe9s :",a),a}catch(a){console.error("Erreur lors de la r\xe9cup\xe9ration :",a)}}),n=(0,s.zD)("sale/updateSale",async(a,e)=>{try{let t=(0,d.H9)(l.db,"sales",a);await (0,d.mZ)(t,e),console.log("Vente mis \xe0 jour !")}catch(a){console.error("Erreur lors de la mise \xe0 jour :",a)}}),c=(0,s.zD)("sale/deleteSale",async a=>{try{await (0,d.kd)((0,d.H9)(l.db,"sales",a)),console.log("Vente supprim\xe9 !")}catch(a){console.error("Erreur lors de la suppression :",a)}}),i=(0,s.zD)("sale/fetchSalesCountToday",async()=>{let a=new Date,e=a.getUTCFullYear(),t=String(a.getUTCMonth()+1).padStart(2,"0"),s=String(a.getUTCDate()).padStart(2,"0"),r="".concat(e,"-").concat(t,"-").concat(s,"T00:00:00.000Z"),o=(0,d.rJ)(l.db,"sales"),n=(0,d.P)(o,(0,d._M)("date","==",r));return(await (0,d.GG)(n)).docs.length}),p=(0,s.zD)("sale/fetchTotalSalesCount",async()=>{let a=(0,d.rJ)(l.db,"sales");return(await (0,d.GG)(a)).docs.length}),u=(0,s.zD)("sale/amountToday",async()=>{let a=new Date,e=a.getUTCFullYear(),t=String(a.getUTCMonth()+1).padStart(2,"0"),s=String(a.getUTCDate()).padStart(2,"0"),r="".concat(e,"-").concat(t,"-").concat(s,"T00:00:00.000Z"),o=(0,d.rJ)(l.db,"sales"),n=(0,d.P)(o,(0,d._M)("date","==",r)),c=await (0,d.GG)(n),i=0;return c.docs.forEach(a=>{let e=a.data();i+=e.total}),i}),m=(0,s.zD)("sale/totalAmount",async()=>{let a=(0,d.rJ)(l.db,"sales"),e=await (0,d.GG)(a),t=0;return e.docs.forEach(a=>{let e=a.data();t+=e.total}),t}),g=(0,s.zD)("sale/last10",async()=>{let a=(0,d.rJ)(l.db,"sales"),e=(0,d.P)(a,(0,d.My)("date","desc"),(0,d.AB)(10));return(await (0,d.GG)(e)).docs.map(a=>({id:a.id,...a.data()}))}),x=(0,s.zD)("sale/last7Days",async()=>{let a=new Date,e=new Date;e.setDate(a.getDate()-7),e.setHours(0,0,0,0);let t="".concat(e.getUTCFullYear(),"-").concat(String(e.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(e.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z"),s=(0,d.rJ)(l.db,"sales"),r=(0,d.P)(s,(0,d._M)("date",">=",t)),o=await (0,d.GG)(r),n={};for(let e=6;e>=0;e--){let t=new Date;t.setDate(a.getDate()-e),n["".concat(t.getUTCFullYear(),"-").concat(String(t.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(t.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z").split("T")[0]]=0}return o.docs.forEach(a=>{let e=a.data(),t=new Date(e.date),s="".concat(t.getUTCFullYear(),"-").concat(String(t.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(t.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z").split("T")[0];n.hasOwnProperty(s)&&(n[s]+=e.total)}),n}),h=(0,s.zD)("sale/byProduct",async()=>{let a=(0,d.rJ)(l.db,"sales"),e=await (0,d.GG)(a),t={};return e.docs.forEach(a=>{a.data().articles.forEach(a=>{t[a.nom]||(t[a.nom]=0),t[a.nom]+=a.total})}),t}),f=(0,s.Z0)({name:"sale",initialState:{loading:!1,salesLast7Days:[],sales:null,error:"",salesByProduct:[],salesCountToday:0,totalSalesCount:0,salesAmountToday:0,totalSalesAmount:0},reducers:{},extraReducers:a=>{a.addCase(r.pending,a=>{a.loading=!0}).addCase(r.fulfilled,a=>{a.loading=!1}).addCase(r.rejected,(a,e)=>{a.loading=!1,a.error=e.payload}).addCase(o.pending,a=>{a.loading=!0}).addCase(o.fulfilled,(a,e)=>{a.loading=!1,a.sales=e.payload}).addCase(o.rejected,(a,e)=>{a.loading=!1,a.error=e.payload}).addCase(n.pending,a=>{a.loading=!0}).addCase(n.fulfilled,a=>{a.loading=!1}).addCase(n.rejected,(a,e)=>{a.loading=!1,a.error=e.payload}).addCase(c.pending,a=>{a.loading=!0}).addCase(c.fulfilled,a=>{a.loading=!1}).addCase(c.rejected,(a,e)=>{a.loading=!1,a.error=e.payload}).addCase(i.fulfilled,(a,e)=>{a.salesCountToday=e.payload}).addCase(p.fulfilled,(a,e)=>{a.totalSalesCount=e.payload}).addCase(u.fulfilled,(a,e)=>{a.salesAmountToday=e.payload}).addCase(m.fulfilled,(a,e)=>{a.totalSalesAmount=e.payload}).addCase(g.fulfilled,(a,e)=>{a.sales=e.payload}).addCase(x.fulfilled,(a,e)=>{a.salesLast7Days=e.payload}).addCase(h.fulfilled,(a,e)=>{a.salesByProduct=e.payload})}}).reducer},14732:(a,e,t)=>{"use strict";t.d(e,{l:()=>s});let s=a=>{let e=new Date(a),t=String(e.getUTCDate()).padStart(2,"0"),s=String(e.getUTCMonth()+1).padStart(2,"0"),d=e.getUTCFullYear();return"".concat(t," ").concat(s," ").concat(d)}},75033:(a,e,t)=>{"use strict";t.d(e,{db:()=>r});var s=t(49904),d=t(27058);let l=(0,s.Wp)({apiKey:"AIzaSyASZSWBGwPJYuQDRi1GObaNtrccuaBfu70",authDomain:"bgmultiservices-781c8.firebaseapp.com",projectId:"bgmultiservices-781c8",messagingSenderId:"749311417727",appId:"1:749311417727:web:3ea8698ba8ac3ac7ac8e4a"}),r=(0,d.aU)(l)}},a=>{var e=e=>a(a.s=e);a.O(0,[992,647,876,23,233,441,517,358],()=>e(20566)),_N_E=a.O()}]);