(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[298],{97409:(e,r,a)=>{Promise.resolve().then(a.bind(a,50805))},76046:(e,r,a)=>{"use strict";var s=a(66658);a.o(s,"usePathname")&&a.d(r,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(r,{useRouter:function(){return s.useRouter}})},50805:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>n});var s=a(95155),t=a(12115),l=a(83391),d=a(81654);let i=(0,a(14057).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var o=a(76046);function n(){let e=(0,l.wA)(),r=(0,l.d4)(e=>e.auth.users),a=(0,l.d4)(e=>e.auth.user),n=(0,o.useRouter)(),[u,c]=(0,t.useState)({name:"",password:"",role:"utilisateur"});(0,t.useEffect)(()=>{e((0,d.hU)()),e((0,d.Ny)())},[e]);let m=r=>{e((0,d.hG)(r))};return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Gestion des utilisateurs"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("span",{className:"block",children:["nom: ",null==a?void 0:a.name]}),(0,s.jsxs)("span",{className:"block",children:["role: ",null==a?void 0:a.role]})]}),(0,s.jsx)("h2",{className:"text-[20px] font-bold mb-2",children:"Ajouter un nouveau utilisateur"}),(0,s.jsxs)("form",{onSubmit:r=>{r.preventDefault(),e((0,d.kg)(u)),c({name:"",password:"",role:"utilisateur"})},className:"mb-6 space-y-2",children:[(0,s.jsx)("input",{type:"text",placeholder:"Nom",value:u.name,onChange:e=>c({...u,name:e.target.value}),className:"border p-2 rounded w-full",required:!0}),(0,s.jsx)("input",{type:"password",placeholder:"Mot de passe",value:u.password,onChange:e=>c({...u,password:e.target.value}),className:"border p-2 rounded w-full",required:!0}),(0,s.jsxs)("select",{value:u.role,onChange:e=>c({...u,role:e.target.value}),className:"border p-2 rounded w-full",children:[(0,s.jsx)("option",{value:"caissier",children:"Caissier"}),(0,s.jsx)("option",{value:"impression",children:"Impression"}),(0,s.jsx)("option",{value:"admin",children:"Admin"})]}),(0,s.jsx)("button",{type:"submit",className:"bg-blue-500 text-white p-2 rounded w-full",children:"Cr\xe9er un utilisateur"})]}),(0,s.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-200",children:[(0,s.jsx)("th",{className:"border p-2",children:"Nom"}),(0,s.jsx)("th",{className:"border p-2",children:"R\xf4le"}),(0,s.jsx)("th",{className:"border p-2",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:r.map(e=>(0,s.jsxs)("tr",{className:"text-center",children:[(0,s.jsx)("td",{className:"border p-2",children:e.name}),(0,s.jsx)("td",{className:"border p-2",children:e.role}),(0,s.jsx)("td",{className:"border p-2",children:(0,s.jsx)("button",{onClick:()=>m(e.id),className:"bg-red-500 text-white px-3 py-1 rounded",children:"Supprimer"})})]},e.id))})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("span",{className:"flex text-red-500 mt-4 cursor-pointer",onClick:()=>{e((0,d.ri)()),n.push("/connexion")},children:[(0,s.jsx)(i,{})," Deconnexion"]})})]})}},81654:(e,r,a)=>{"use strict";a.d(r,{Ay:()=>x,Lx:()=>d,Ny:()=>p,hG:()=>c,hU:()=>o,kg:()=>i,ri:()=>h});var s=a(48943),t=a(75033),l=a(27058);let d=(0,s.zD)("auth/loginUser",async e=>{let{name:r,password:a}=e,s=(0,l.rJ)(t.db,"users"),d=(0,l.P)(s,(0,l._M)("name","==",r),(0,l._M)("password","==",a)),i=await (0,l.GG)(d);if(!i.empty){let e=i.docs[0].id,r=(0,l.H9)(t.db,"users",e),a=await (0,l.x7)(r),s=a.data();if(s)return localStorage.setItem("id",a.id),localStorage.setItem("name",s.name),localStorage.setItem("role",s.role),{name:s.name,id:a.id,role:s.role}}throw Error("Identifiants incorrects")}),i=(0,s.zD)("auth/createUser",async e=>{let r=(0,l.rJ)(t.db,"users"),a=await (0,l.gS)(r,e);return{...e,id:a.id}}),o=(0,s.zD)("auth/fetchUsers",async()=>{let e=(0,l.rJ)(t.db,"users");return(await (0,l.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}),n=(0,s.zD)("auth/fetchUserById",async e=>{let r=(0,l.H9)(t.db,"users",e),a=await (0,l.x7)(r);if(a.exists())return{id:a.id,...a.data()};throw Error("Utilisateur non trouv\xe9")}),u=(0,s.zD)("auth/updateUser",async e=>{if(!e.id)throw Error("User ID is required");let r=(0,l.H9)(t.db,"users",e.id),{id:a,...s}=e;return await (0,l.mZ)(r,s),e}),c=(0,s.zD)("auth/deleteUser",async e=>{let r=(0,l.H9)(t.db,"users",e);return await (0,l.kd)(r),e}),m=(0,s.Z0)({name:"auth",initialState:{user:null,users:[]},reducers:{logout:e=>{e.user=null,localStorage.removeItem("id"),localStorage.removeItem("name"),localStorage.removeItem("role")},currentUser:e=>{e.user={id:localStorage.getItem("id")||"",name:localStorage.getItem("name")||"",role:localStorage.getItem("role")||""}}},extraReducers:e=>{e.addCase(d.fulfilled,(e,r)=>{e.user=r.payload}).addCase(o.fulfilled,(e,r)=>{e.users=r.payload}).addCase(n.fulfilled,(e,r)=>{e.users.find(e=>e.id===r.payload.id)||e.users.push(r.payload)}).addCase(i.fulfilled,(e,r)=>{e.users.push(r.payload)}).addCase(u.fulfilled,(e,r)=>{let a=e.users.findIndex(e=>e.id===r.payload.id);-1!==a&&(e.users[a]=r.payload)}).addCase(c.fulfilled,(e,r)=>{e.users=e.users.filter(e=>e.id!==r.payload)})}}),{logout:h,currentUser:p}=m.actions,x=m.reducer},75033:(e,r,a)=>{"use strict";a.d(r,{db:()=>d});var s=a(49904),t=a(27058);let l=(0,s.Wp)({apiKey:"AIzaSyASZSWBGwPJYuQDRi1GObaNtrccuaBfu70",authDomain:"bgmultiservices-781c8.firebaseapp.com",projectId:"bgmultiservices-781c8",messagingSenderId:"749311417727",appId:"1:749311417727:web:3ea8698ba8ac3ac7ac8e4a"}),d=(0,t.aU)(l)},14057:(e,r,a)=>{"use strict";a.d(r,{A:()=>o});var s=a(12115);let t=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return r.filter((e,r,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===r).join(" ").trim()};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,s.forwardRef)((e,r)=>{let{color:a="currentColor",size:t=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:n="",children:u,iconNode:c,...m}=e;return(0,s.createElement)("svg",{ref:r,...d,width:t,height:t,stroke:a,strokeWidth:o?24*Number(i)/Number(t):i,className:l("lucide",n),...m},[...c.map(e=>{let[r,a]=e;return(0,s.createElement)(r,a)}),...Array.isArray(u)?u:[u]])}),o=(e,r)=>{let a=(0,s.forwardRef)((a,d)=>{let{className:o,...n}=a;return(0,s.createElement)(i,{ref:d,iconNode:r,className:l("lucide-".concat(t(e)),o),...n})});return a.displayName="".concat(e),a}}},e=>{var r=r=>e(e.s=r);e.O(0,[992,876,441,517,358],()=>r(97409)),_N_E=e.O()}]);