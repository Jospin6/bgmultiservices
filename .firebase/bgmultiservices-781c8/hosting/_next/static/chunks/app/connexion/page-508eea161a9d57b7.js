(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[106],{24049:(e,a,r)=>{Promise.resolve().then(r.bind(r,31557))},76046:(e,a,r)=>{"use strict";var t=r(66658);r.o(t,"usePathname")&&r.d(a,{usePathname:function(){return t.usePathname}}),r.o(t,"useRouter")&&r.d(a,{useRouter:function(){return t.useRouter}})},31557:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>u});var t=r(95155),s=r(12115),l=r(83391),d=r(81654),o=r(76046);function u(){let[e,a]=(0,s.useState)(""),[r,u]=(0,s.useState)(""),i=(0,l.wA)(),n=(0,o.useRouter)(),c=async a=>{a.preventDefault();try{await i((0,d.Lx)({name:e,password:r})).unwrap()?n.push("/"):console.error("Identifiants incorrects")}catch(e){console.error("Erreur de connexion :",e)}};return(0,t.jsxs)("div",{className:"w-[300px] mt-4 m-auto",children:[(0,t.jsx)("h2",{className:"text-2xl pb-4",children:"Connexion"}),(0,t.jsxs)("form",{onSubmit:c,children:[(0,t.jsx)("input",{type:"text",placeholder:"Votre nom",className:"block pl-2 border-[1px] border-gray-300 w-full rounded-lg h-[35px] mb-2",onChange:e=>a(e.target.value)}),(0,t.jsx)("input",{type:"password",placeholder:"Mot de passe",className:"block pl-2 border-[1px] border-gray-300 w-full rounded-lg h-[35px]",onChange:e=>u(e.target.value)}),(0,t.jsx)("button",{type:"submit",className:"px-[10px] py-[3px] rounded-lg bg-blue-400 my-2 text-gray-100",children:"Se connecter"})]})]})}},81654:(e,a,r)=>{"use strict";r.d(a,{Ay:()=>f,Lx:()=>d,Ny:()=>h,hG:()=>c,hU:()=>u,kg:()=>o,ri:()=>p});var t=r(48943),s=r(75033),l=r(27058);let d=(0,t.zD)("auth/loginUser",async e=>{let{name:a,password:r}=e,t=(0,l.rJ)(s.db,"users"),d=(0,l.P)(t,(0,l._M)("name","==",a),(0,l._M)("password","==",r)),o=await (0,l.GG)(d);if(!o.empty){let e=o.docs[0].id,a=(0,l.H9)(s.db,"users",e),r=await (0,l.x7)(a),t=r.data();if(t)return localStorage.setItem("id",r.id),localStorage.setItem("name",t.name),localStorage.setItem("role",t.role),{name:t.name,id:r.id,role:t.role}}throw Error("Identifiants incorrects")}),o=(0,t.zD)("auth/createUser",async e=>{let a=(0,l.rJ)(s.db,"users"),r=await (0,l.gS)(a,e);return{...e,id:r.id}}),u=(0,t.zD)("auth/fetchUsers",async()=>{let e=(0,l.rJ)(s.db,"users");return(await (0,l.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}),i=(0,t.zD)("auth/fetchUserById",async e=>{let a=(0,l.H9)(s.db,"users",e),r=await (0,l.x7)(a);if(r.exists())return{id:r.id,...r.data()};throw Error("Utilisateur non trouv\xe9")}),n=(0,t.zD)("auth/updateUser",async e=>{if(!e.id)throw Error("User ID is required");let a=(0,l.H9)(s.db,"users",e.id),{id:r,...t}=e;return await (0,l.mZ)(a,t),e}),c=(0,t.zD)("auth/deleteUser",async e=>{let a=(0,l.H9)(s.db,"users",e);return await (0,l.kd)(a),e}),m=(0,t.Z0)({name:"auth",initialState:{user:null,users:[]},reducers:{logout:e=>{e.user=null,localStorage.removeItem("id"),localStorage.removeItem("name"),localStorage.removeItem("role")},currentUser:e=>{e.user={id:localStorage.getItem("id")||"",name:localStorage.getItem("name")||"",role:localStorage.getItem("role")||""}},checkUser:e=>{let a=localStorage.getItem("id"),r=localStorage.getItem("name"),t=localStorage.getItem("role");a&&r&&t?e.user={id:a,name:r,role:t}:e.user=null}},extraReducers:e=>{e.addCase(d.fulfilled,(e,a)=>{e.user=a.payload}).addCase(u.fulfilled,(e,a)=>{e.users=a.payload}).addCase(i.fulfilled,(e,a)=>{e.users.find(e=>e.id===a.payload.id)||e.users.push(a.payload)}).addCase(o.fulfilled,(e,a)=>{e.users.push(a.payload)}).addCase(n.fulfilled,(e,a)=>{let r=e.users.findIndex(e=>e.id===a.payload.id);-1!==r&&(e.users[r]=a.payload)}).addCase(c.fulfilled,(e,a)=>{e.users=e.users.filter(e=>e.id!==a.payload)})}}),{logout:p,currentUser:h,checkUser:g}=m.actions,f=m.reducer},75033:(e,a,r)=>{"use strict";r.d(a,{db:()=>d});var t=r(49904),s=r(27058);let l=(0,t.Wp)({apiKey:"AIzaSyASZSWBGwPJYuQDRi1GObaNtrccuaBfu70",authDomain:"bgmultiservices-781c8.firebaseapp.com",projectId:"bgmultiservices-781c8",messagingSenderId:"749311417727",appId:"1:749311417727:web:3ea8698ba8ac3ac7ac8e4a"}),d=(0,s.aU)(l)}},e=>{var a=a=>e(e.s=a);e.O(0,[992,876,441,517,358],()=>a(24049)),_N_E=e.O()}]);