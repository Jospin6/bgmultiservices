(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{28355:(e,a,t)=>{Promise.resolve().then(t.bind(t,75392))},76046:(e,a,t)=>{"use strict";var s=t(66658);t.o(s,"usePathname")&&t.d(a,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}})},75392:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>D});var s=t(95155),r=t(62093),l=t.n(r),d=t(27735),o=t.n(d);t(30347);var n=t(83391),i=t(48943),c=t(81654),u=t(94321),p=t(29009),m=t(52587);let y=(0,i.U1)({reducer:{auth:c.Ay,product:u.Ay,sale:p.Ay,impression:m.Ay}});var f=t(12115);let h=e=>{let{children:a}=e;return(0,s.jsx)(n.Kq,{store:y,children:a})};var g=t(48173),C=t.n(g),x=t(14057);let S=(0,x.A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),b=(0,x.A)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),v=()=>{let[e,a]=(0,f.useState)(!1),t=(0,n.wA)(),{user:r}=(0,n.d4)(e=>e.auth);return(0,f.useEffect)(()=>{t((0,c.Ny)())},[t]),(0,s.jsxs)("nav",{className:"w-full min-h-[80px] h-auto bg-blue-400 text-white shadow-md",children:[(0,s.jsxs)("div",{className:"container mx-auto flex justify-between items-center h-full px-6",children:[(0,s.jsx)("div",{className:"lg:text-2xl text-xl font-bold",children:"BgMultiServices"}),(0,s.jsxs)("div",{className:"hidden md:flex space-x-8 text-lg",children:[null!=r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C(),{href:"/",className:"hover:text-gray-200 transition",children:"Accueil"}),(null==r?void 0:r.role)!="impression"&&(0,s.jsx)(C(),{href:"/sales",className:"hover:text-gray-200 transition",children:"Vente"}),(null==r?void 0:r.role)==="admin"&&(0,s.jsx)(C(),{href:"/products",className:"hover:text-gray-200 transition",children:"Produits"}),(null==r?void 0:r.role)!="caissier"&&(0,s.jsx)(C(),{href:"/impressions",className:"hover:text-gray-200 transition",children:"Impression"})]}),(0,s.jsx)(C(),{href:"/account",className:"hover:text-gray-200 transition",children:"Compte"})]}),(0,s.jsx)("div",{className:"md:hidden",children:(0,s.jsx)("button",{onClick:()=>a(!e),children:e?(0,s.jsx)(S,{size:28}):(0,s.jsx)(b,{size:28})})})]}),e&&(0,s.jsx)("div",{className:"md:hidden bg-blue-700 py-4 z-[100]",children:(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-4 text-lg",children:[(0,s.jsx)(C(),{href:"/",className:"hover:text-gray-200 transition",onClick:()=>a(!1),children:"Accueil"}),(0,s.jsx)(C(),{href:"/sales",className:"hover:text-gray-200 transition",onClick:()=>a(!1),children:"Vente"}),(0,s.jsx)(C(),{href:"/products",className:"hover:text-gray-200 transition",onClick:()=>a(!1),children:"Produits"}),(0,s.jsx)(C(),{href:"/impressions",className:"hover:text-gray-200 transition",onClick:()=>a(!1),children:"Impressions"}),(0,s.jsx)(C(),{href:"/account",className:"hover:text-gray-200 transition",onClick:()=>a(!1),children:"Compte"})]})})]})};var w=t(76046);function D(e){let{children:a}=e;return(0,w.usePathname)(),(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)("body",{className:"".concat(l().variable," ").concat(o().variable," antialiased"),children:(0,s.jsxs)(h,{children:[(0,s.jsx)(v,{}),(0,s.jsx)("div",{className:"lg:px-[10%] px-2",children:a})]})})})}},81654:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>h,Lx:()=>d,Ny:()=>y,hG:()=>u,hU:()=>n,kg:()=>o,ri:()=>m});var s=t(48943),r=t(75033),l=t(27058);let d=(0,s.zD)("auth/loginUser",async e=>{let{name:a,password:t}=e,s=(0,l.rJ)(r.db,"users"),d=(0,l.P)(s,(0,l._M)("name","==",a),(0,l._M)("password","==",t)),o=await (0,l.GG)(d);if(!o.empty){let e=o.docs[0].id,a=(0,l.H9)(r.db,"users",e),t=await (0,l.x7)(a),s=t.data();if(s)return localStorage.setItem("id",t.id),localStorage.setItem("name",s.name),localStorage.setItem("role",s.role),{name:s.name,id:t.id,role:s.role}}throw Error("Identifiants incorrects")}),o=(0,s.zD)("auth/createUser",async e=>{let a=(0,l.rJ)(r.db,"users"),t=await (0,l.gS)(a,e);return{...e,id:t.id}}),n=(0,s.zD)("auth/fetchUsers",async()=>{let e=(0,l.rJ)(r.db,"users");return(await (0,l.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}),i=(0,s.zD)("auth/fetchUserById",async e=>{let a=(0,l.H9)(r.db,"users",e),t=await (0,l.x7)(a);if(t.exists())return{id:t.id,...t.data()};throw Error("Utilisateur non trouv\xe9")}),c=(0,s.zD)("auth/updateUser",async e=>{if(!e.id)throw Error("User ID is required");let a=(0,l.H9)(r.db,"users",e.id),{id:t,...s}=e;return await (0,l.mZ)(a,s),e}),u=(0,s.zD)("auth/deleteUser",async e=>{let a=(0,l.H9)(r.db,"users",e);return await (0,l.kd)(a),e}),p=(0,s.Z0)({name:"auth",initialState:{user:null,users:[]},reducers:{logout:e=>{e.user=null,localStorage.removeItem("id"),localStorage.removeItem("name"),localStorage.removeItem("role")},currentUser:e=>{e.user={id:localStorage.getItem("id")||"",name:localStorage.getItem("name")||"",role:localStorage.getItem("role")||""}},checkUser:e=>{let a=localStorage.getItem("id"),t=localStorage.getItem("name"),s=localStorage.getItem("role");a&&t&&s?e.user={id:a,name:t,role:s}:e.user=null}},extraReducers:e=>{e.addCase(d.fulfilled,(e,a)=>{e.user=a.payload}).addCase(n.fulfilled,(e,a)=>{e.users=a.payload}).addCase(i.fulfilled,(e,a)=>{e.users.find(e=>e.id===a.payload.id)||e.users.push(a.payload)}).addCase(o.fulfilled,(e,a)=>{e.users.push(a.payload)}).addCase(c.fulfilled,(e,a)=>{let t=e.users.findIndex(e=>e.id===a.payload.id);-1!==t&&(e.users[t]=a.payload)}).addCase(u.fulfilled,(e,a)=>{e.users=e.users.filter(e=>e.id!==a.payload)})}}),{logout:m,currentUser:y,checkUser:f}=p.actions,h=p.reducer},52587:(e,a,t)=>{"use strict";t.d(a,{$y:()=>i,Ay:()=>m,GT:()=>p,Xv:()=>n,dd:()=>c,wG:()=>u});var s=t(48943),r=t(27058),l=t(75033),d=t(21455),o=t.n(d);let n=(0,s.zD)("impression/addImpression",async e=>({id:(await (0,r.gS)((0,r.rJ)(l.db,"impressions"),e)).id,...e})),i=(0,s.zD)("impression/fetchImpressions",async()=>(await (0,r.GG)((0,r.rJ)(l.db,"impressions"))).docs.map(e=>({id:e.id,...e.data()}))),c=(0,s.zD)("impression/deleteImpression",async e=>(await (0,r.kd)((0,r.H9)(l.db,"impressions",e)),e)),u=(0,s.zD)("impression/amountCurrentMonth",async()=>{let e=o()().startOf("month").format("YYYY-MM"),a=(0,r.rJ)(l.db,"impressions"),t=(0,r.P)(a,(0,r._M)("date",">=",e)),s=await (0,r.GG)(t),d=0;return s.docs.forEach(e=>{d+=e.data().amount||0}),d}),p=(0,s.zD)("impression/papersCountCurrentMonth",async()=>{let e=o()().startOf("month").format("YYYY-MM"),a=(0,r.rJ)(l.db,"impressions"),t=(0,r.P)(a,(0,r._M)("date",">=",e)),s=await (0,r.GG)(t),d=0;return s.docs.forEach(e=>{d+=e.data().totalPapers||0}),d}),m=(0,s.Z0)({name:"impression",initialState:{loading:!1,impression:null,error:"",impressionsAmountCurrentMonth:0,printedPapersCountCurrentMonth:0},reducers:{},extraReducers:e=>{e.addCase(i.pending,e=>{e.loading=!0}),e.addCase(i.fulfilled,(e,a)=>{e.loading=!1,e.impression=a.payload}),e.addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.payload||"An error occurred"}),e.addCase(n.fulfilled,(e,a)=>{e.impression=e.impression?[...e.impression,a.payload]:[a.payload]}),e.addCase(c.fulfilled,(e,a)=>{e.impression&&(e.impression=e.impression.filter(e=>e.id!==a.payload))}),e.addCase(u.fulfilled,(e,a)=>{e.impressionsAmountCurrentMonth=a.payload}),e.addCase(p.fulfilled,(e,a)=>{e.printedPapersCountCurrentMonth=a.payload})}}).reducer},94321:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>u,Bj:()=>d,DD:()=>i,Qu:()=>c,j0:()=>o,vc:()=>n});var s=t(48943),r=t(27058),l=t(75033);let d=(0,s.zD)("product/addProduct",async e=>({id:(await (0,r.gS)((0,r.rJ)(l.db,"products"),e)).id,...e})),o=(0,s.zD)("product/fetchProducts",async()=>(await (0,r.GG)((0,r.rJ)(l.db,"products"))).docs.map(e=>({id:e.id,...e.data()}))),n=(0,s.zD)("product/updateProduct",async e=>{let{id:a,newStock:t}=e,s=(0,r.H9)(l.db,"products",a);return await (0,r.mZ)(s,{stock:t}),{id:a,newStock:t}}),i=(0,s.zD)("product/deleteProduct",async e=>(await (0,r.kd)((0,r.H9)(l.db,"products",e)),e)),c=(0,s.zD)("product/totalStock",async()=>{let e=(0,r.rJ)(l.db,"products"),a=await (0,r.GG)(e),t=0;return a.docs.forEach(e=>{t+=e.data().stock||0}),t}),u=(0,s.Z0)({name:"product",initialState:{loading:!1,products:null,error:"",totalProductsInStock:0},reducers:{},extraReducers:e=>{e.addCase(o.pending,e=>{e.loading=!0}),e.addCase(o.fulfilled,(e,a)=>{e.loading=!1,e.products=a.payload}),e.addCase(o.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}),e.addCase(d.fulfilled,(e,a)=>{e.products=e.products?[...e.products,a.payload]:[a.payload]}),e.addCase(n.fulfilled,(e,a)=>{e.products&&(e.products=e.products.map(e=>e.id===a.payload.id?{...e,stock:a.payload.newStock}:e))}),e.addCase(i.fulfilled,(e,a)=>{e.products&&(e.products=e.products.filter(e=>e.id!==a.payload))}),e.addCase(c.fulfilled,(e,a)=>{e.totalProductsInStock=a.payload})}}).reducer},29009:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>g,FQ:()=>c,Op:()=>p,RA:()=>m,Vf:()=>d,aK:()=>u,dS:()=>i,h8:()=>f,j3:()=>o,ke:()=>y});var s=t(48943),r=t(27058),l=t(75033);let d=(0,s.zD)("sale/addSale",async e=>{try{let a=await (0,r.gS)((0,r.rJ)(l.db,"sales"),e);console.log("Vente ajout\xe9 avec ID :",a.id)}catch(e){console.error("Erreur lors de l'ajout :",e)}}),o=(0,s.zD)("sale/fetchSales",async()=>{try{let e=(await (0,r.GG)((0,r.rJ)(l.db,"sales"))).docs.map(e=>({id:e.id,...e.data()}));return console.log("ventes r\xe9cup\xe9r\xe9s :",e),e}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration :",e)}}),n=(0,s.zD)("sale/updateSale",async(e,a)=>{try{let t=(0,r.H9)(l.db,"sales",e);await (0,r.mZ)(t,a),console.log("Vente mis \xe0 jour !")}catch(e){console.error("Erreur lors de la mise \xe0 jour :",e)}}),i=(0,s.zD)("sale/deleteSale",async e=>{try{await (0,r.kd)((0,r.H9)(l.db,"sales",e)),console.log("Vente supprim\xe9 !")}catch(e){console.error("Erreur lors de la suppression :",e)}}),c=(0,s.zD)("sale/fetchSalesCountToday",async()=>{let e=new Date,a=e.getUTCFullYear(),t=String(e.getUTCMonth()+1).padStart(2,"0"),s=String(e.getUTCDate()).padStart(2,"0"),d="".concat(a,"-").concat(t,"-").concat(s,"T00:00:00.000Z"),o=(0,r.rJ)(l.db,"sales"),n=(0,r.P)(o,(0,r._M)("date","==",d));return(await (0,r.GG)(n)).docs.length}),u=(0,s.zD)("sale/fetchTotalSalesCount",async()=>{let e=(0,r.rJ)(l.db,"sales");return(await (0,r.GG)(e)).docs.length}),p=(0,s.zD)("sale/amountToday",async()=>{let e=new Date,a=e.getUTCFullYear(),t=String(e.getUTCMonth()+1).padStart(2,"0"),s=String(e.getUTCDate()).padStart(2,"0"),d="".concat(a,"-").concat(t,"-").concat(s,"T00:00:00.000Z"),o=(0,r.rJ)(l.db,"sales"),n=(0,r.P)(o,(0,r._M)("date","==",d)),i=await (0,r.GG)(n),c=0;return i.docs.forEach(e=>{let a=e.data();c+=a.total}),c}),m=(0,s.zD)("sale/totalAmount",async()=>{let e=(0,r.rJ)(l.db,"sales"),a=await (0,r.GG)(e),t=0;return a.docs.forEach(e=>{let a=e.data();t+=a.total}),t}),y=(0,s.zD)("sale/last10",async()=>{let e=(0,r.rJ)(l.db,"sales"),a=(0,r.P)(e,(0,r.My)("date","desc"),(0,r.AB)(10));return(await (0,r.GG)(a)).docs.map(e=>({id:e.id,...e.data()}))}),f=(0,s.zD)("sale/last7Days",async()=>{let e=new Date,a=new Date;a.setDate(e.getDate()-7),a.setHours(0,0,0,0);let t="".concat(a.getUTCFullYear(),"-").concat(String(a.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(a.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z"),s=(0,r.rJ)(l.db,"sales"),d=(0,r.P)(s,(0,r._M)("date",">=",t)),o=await (0,r.GG)(d),n={};for(let a=6;a>=0;a--){let t=new Date;t.setDate(e.getDate()-a),n["".concat(t.getUTCFullYear(),"-").concat(String(t.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(t.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z").split("T")[0]]=0}return o.docs.forEach(e=>{let a=e.data(),t=new Date(a.date),s="".concat(t.getUTCFullYear(),"-").concat(String(t.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(t.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z").split("T")[0];n.hasOwnProperty(s)&&(n[s]+=a.total)}),n}),h=(0,s.zD)("sale/byProduct",async()=>{let e=(0,r.rJ)(l.db,"sales"),a=await (0,r.GG)(e),t={};return a.docs.forEach(e=>{e.data().articles.forEach(e=>{t[e.nom]||(t[e.nom]=0),t[e.nom]+=e.total})}),t}),g=(0,s.Z0)({name:"sale",initialState:{loading:!1,salesLast7Days:[],sales:null,error:"",salesByProduct:[],salesCountToday:0,totalSalesCount:0,salesAmountToday:0,totalSalesAmount:0},reducers:{},extraReducers:e=>{e.addCase(d.pending,e=>{e.loading=!0}).addCase(d.fulfilled,e=>{e.loading=!1}).addCase(d.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(o.pending,e=>{e.loading=!0}).addCase(o.fulfilled,(e,a)=>{e.loading=!1,e.sales=a.payload}).addCase(o.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(n.pending,e=>{e.loading=!0}).addCase(n.fulfilled,e=>{e.loading=!1}).addCase(n.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.loading=!0}).addCase(i.fulfilled,e=>{e.loading=!1}).addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(c.fulfilled,(e,a)=>{e.salesCountToday=a.payload}).addCase(u.fulfilled,(e,a)=>{e.totalSalesCount=a.payload}).addCase(p.fulfilled,(e,a)=>{e.salesAmountToday=a.payload}).addCase(m.fulfilled,(e,a)=>{e.totalSalesAmount=a.payload}).addCase(y.fulfilled,(e,a)=>{e.sales=a.payload}).addCase(f.fulfilled,(e,a)=>{e.salesLast7Days=a.payload}).addCase(h.fulfilled,(e,a)=>{e.salesByProduct=a.payload})}}).reducer},75033:(e,a,t)=>{"use strict";t.d(a,{db:()=>d});var s=t(49904),r=t(27058);let l=(0,s.Wp)({apiKey:"AIzaSyASZSWBGwPJYuQDRi1GObaNtrccuaBfu70",authDomain:"bgmultiservices-781c8.firebaseapp.com",projectId:"bgmultiservices-781c8",messagingSenderId:"749311417727",appId:"1:749311417727:web:3ea8698ba8ac3ac7ac8e4a"}),d=(0,r.aU)(l)},30347:()=>{},62093:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_4d318d",variable:"__variable_4d318d"}},27735:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_ea5f4b",variable:"__variable_ea5f4b"}}},e=>{var a=a=>e(e.s=a);e.O(0,[360,992,876,23,441,517,358],()=>a(28355)),_N_E=e.O()}]);