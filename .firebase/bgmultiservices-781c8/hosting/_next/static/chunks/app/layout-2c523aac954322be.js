(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{42640:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,62093,23)),Promise.resolve().then(t.t.bind(t,27735,23)),Promise.resolve().then(t.t.bind(t,30347,23)),Promise.resolve().then(t.bind(t,36625)),Promise.resolve().then(t.bind(t,70449))},36625:(e,a,t)=>{"use strict";t.d(a,{NavBar:()=>p});var s=t(95155),r=t(12115),d=t(48173),l=t.n(d),o=t(689),i=t(87936),n=t(83391),c=t(81654),u=t(5565);let p=()=>{let[e,a]=(0,r.useState)(!1),t=(0,n.wA)(),{user:d}=(0,n.d4)(e=>e.auth);return(0,r.useEffect)(()=>{t((0,c.Ny)())},[t]),(0,s.jsxs)("nav",{className:"w-full min-h-[80px] h-auto bg-gray-800 text-white shadow-md",children:[(0,s.jsxs)("div",{className:"container mx-auto min-h-[80px] flex justify-between items-center h-full px-6",children:[(0,s.jsx)(u.default,{src:"/images/logo.jpg",alt:"logo",className:"rounded-full ",width:60,height:60}),(0,s.jsxs)("div",{className:"hidden md:flex space-x-8 text-lg",children:[(0,s.jsx)(l(),{href:"/",className:"hover:text-gray-200 transition",children:"Accueil"}),(null==d?void 0:d.name)!=""&&(0,s.jsxs)(s.Fragment,{children:[((null==d?void 0:d.role)=="admin"||(null==d?void 0:d.role)=="caissier")&&(0,s.jsx)(l(),{href:"/sales",className:"hover:text-gray-200 transition",children:"Vente"}),(null==d?void 0:d.role)==="admin"&&(0,s.jsx)(l(),{href:"/products",className:"hover:text-gray-200 transition",children:"Produits"}),((null==d?void 0:d.role)=="admin"||(null==d?void 0:d.role)=="impression")&&(0,s.jsx)(l(),{href:"/impressions",className:"hover:text-gray-200 transition",children:"Impression"}),(0,s.jsx)(l(),{href:"/account",className:"hover:text-gray-200 transition",children:"Compte"})]})]}),(0,s.jsx)("div",{className:"md:hidden",children:(0,s.jsx)("button",{onClick:()=>a(!e),children:e?(0,s.jsx)(o.A,{size:28}):(0,s.jsx)(i.A,{size:28})})})]}),e&&(0,s.jsx)("div",{className:"md:hidden bg-blue-700 py-4 z-[100]",children:(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-4 text-lg",children:[(0,s.jsx)(l(),{href:"/",className:"hover:text-gray-200 transition",onClick:()=>a(!1),children:"Accueil"}),(null==d?void 0:d.name)!=""&&(0,s.jsxs)(s.Fragment,{children:[((null==d?void 0:d.role)=="admin"||(null==d?void 0:d.role)=="caissier")&&(0,s.jsx)(l(),{href:"/sales",className:"hover:text-gray-200 transition",onClick:()=>a(!1),children:"Vente"}),(null==d?void 0:d.role)==="admin"&&(0,s.jsx)(l(),{href:"/products",className:"hover:text-gray-200 transition",onClick:()=>a(!1),children:"Produits"}),((null==d?void 0:d.role)=="admin"||(null==d?void 0:d.role)=="impression")&&(0,s.jsx)(l(),{href:"/impressions",className:"hover:text-gray-200 transition",onClick:()=>a(!1),children:"Impression"}),(0,s.jsx)(l(),{href:"/account",className:"hover:text-gray-200 transition",onClick:()=>a(!1),children:"Compte"})]})]})})]})}},81654:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>h,Lx:()=>l,Ny:()=>y,hG:()=>u,hU:()=>i,kg:()=>o,ri:()=>m});var s=t(48943),r=t(75033),d=t(27058);let l=(0,s.zD)("auth/loginUser",async e=>{let{name:a,password:t}=e,s=(0,d.rJ)(r.db,"users"),l=(0,d.P)(s,(0,d._M)("name","==",a),(0,d._M)("password","==",t)),o=await (0,d.GG)(l);if(!o.empty){let e=o.docs[0].id,a=(0,d.H9)(r.db,"users",e),t=await (0,d.x7)(a),s=t.data();if(s)return localStorage.setItem("id",t.id),localStorage.setItem("name",s.name),localStorage.setItem("role",s.role),{name:s.name,id:t.id,role:s.role}}throw Error("Identifiants incorrects")}),o=(0,s.zD)("auth/createUser",async e=>{let a=(0,d.rJ)(r.db,"users"),t=await (0,d.gS)(a,e);return{...e,id:t.id}}),i=(0,s.zD)("auth/fetchUsers",async()=>{let e=(0,d.rJ)(r.db,"users");return(await (0,d.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}),n=(0,s.zD)("auth/fetchUserById",async e=>{let a=(0,d.H9)(r.db,"users",e),t=await (0,d.x7)(a);if(t.exists())return{id:t.id,...t.data()};throw Error("Utilisateur non trouv\xe9")}),c=(0,s.zD)("auth/updateUser",async e=>{if(!e.id)throw Error("User ID is required");let a=(0,d.H9)(r.db,"users",e.id),{id:t,...s}=e;return await (0,d.mZ)(a,s),e}),u=(0,s.zD)("auth/deleteUser",async e=>{let a=(0,d.H9)(r.db,"users",e);return await (0,d.kd)(a),e}),p=(0,s.Z0)({name:"auth",initialState:{user:null,users:[]},reducers:{logout:e=>{e.user=null,localStorage.removeItem("id"),localStorage.removeItem("name"),localStorage.removeItem("role")},currentUser:e=>{e.user={id:localStorage.getItem("id")||"",name:localStorage.getItem("name")||"",role:localStorage.getItem("role")||""}},checkUser:e=>{let a=localStorage.getItem("id"),t=localStorage.getItem("name"),s=localStorage.getItem("role");a&&t&&s?e.user={id:a,name:t,role:s}:e.user=null}},extraReducers:e=>{e.addCase(l.fulfilled,(e,a)=>{e.user=a.payload}).addCase(i.fulfilled,(e,a)=>{e.users=a.payload}).addCase(n.fulfilled,(e,a)=>{e.users.find(e=>e.id===a.payload.id)||e.users.push(a.payload)}).addCase(o.fulfilled,(e,a)=>{e.users.push(a.payload)}).addCase(c.fulfilled,(e,a)=>{let t=e.users.findIndex(e=>e.id===a.payload.id);-1!==t&&(e.users[t]=a.payload)}).addCase(u.fulfilled,(e,a)=>{e.users=e.users.filter(e=>e.id!==a.payload)})}}),{logout:m,currentUser:y,checkUser:f}=p.actions,h=p.reducer},52587:(e,a,t)=>{"use strict";t.d(a,{$y:()=>n,AK:()=>y,Ay:()=>h,GT:()=>p,Xv:()=>i,bH:()=>f,dd:()=>c,oC:()=>m,wG:()=>u});var s=t(48943),r=t(27058),d=t(75033),l=t(21455),o=t.n(l);let i=(0,s.zD)("impression/addImpression",async e=>({id:(await (0,r.gS)((0,r.rJ)(d.db,"impressions"),e)).id,...e})),n=(0,s.zD)("impression/fetchImpressions",async()=>(await (0,r.GG)((0,r.rJ)(d.db,"impressions"))).docs.map(e=>({id:e.id,...e.data()}))),c=(0,s.zD)("impression/deleteImpression",async e=>(await (0,r.kd)((0,r.H9)(d.db,"impressions",e)),e)),u=(0,s.zD)("impression/amountCurrentMonth",async()=>{let e=o()().startOf("month").format("YYYY-MM"),a=(0,r.rJ)(d.db,"impressions"),t=(0,r.P)(a,(0,r._M)("date",">=",e)),s=await (0,r.GG)(t),l=0;return s.docs.forEach(e=>{l+=e.data().amount||0}),l}),p=(0,s.zD)("impression/papersCountCurrentMonth",async()=>{let e=o()().startOf("month").format("YYYY-MM"),a=(0,r.rJ)(d.db,"impressions"),t=(0,r.P)(a,(0,r._M)("date",">=",e)),s=await (0,r.GG)(t),l=0;return s.docs.forEach(e=>{l+=e.data().totalPapers||0}),l}),m=(0,s.zD)("impression/fetchSumDayImpressions",async e=>{let a=(0,r.rJ)(d.db,"impressions"),t=(0,r.P)(a,(0,r._M)("date","==",e)),s=await (0,r.GG)(t),l=0;return s.docs.forEach(e=>{l+=e.data().amount||0}),l}),y=(0,s.zD)("impression/fetchCountDayImpressions",async e=>{let a=(0,r.rJ)(d.db,"impressions"),t=(0,r.P)(a,(0,r._M)("date","==",e)),s=await (0,r.GG)(t),l=0;return s.docs.forEach(e=>{l+=e.data().totalPapers||0}),l}),f=(0,s.zD)("impression/fetchAllDaysImpressions",async e=>{let a=(0,r.rJ)(d.db,"impressions"),t=(0,r.P)(a,(0,r._M)("date","==",e));return(await (0,r.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}),h=(0,s.Z0)({name:"impression",initialState:{loading:!1,impression:null,error:"",impressionsAmountCurrentMonth:0,printedPapersCountCurrentMonth:0,nbrImprDay:0,sumImprDay:0,allImprDay:[]},reducers:{},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0}),e.addCase(n.fulfilled,(e,a)=>{e.loading=!1,e.impression=a.payload}),e.addCase(n.rejected,(e,a)=>{e.loading=!1,e.error=a.payload||"An error occurred"}),e.addCase(i.fulfilled,(e,a)=>{e.impression=e.impression?[...e.impression,a.payload]:[a.payload]}),e.addCase(c.fulfilled,(e,a)=>{e.impression&&(e.impression=e.impression.filter(e=>e.id!==a.payload))}),e.addCase(u.fulfilled,(e,a)=>{e.impressionsAmountCurrentMonth=a.payload}),e.addCase(p.fulfilled,(e,a)=>{e.printedPapersCountCurrentMonth=a.payload}),e.addCase(m.fulfilled,(e,a)=>{e.sumImprDay=a.payload}),e.addCase(y.fulfilled,(e,a)=>{e.nbrImprDay=a.payload}),e.addCase(f.fulfilled,(e,a)=>{e.allImprDay=a.payload})}}).reducer},94321:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>u,Bj:()=>l,DD:()=>n,Qu:()=>c,j0:()=>o,vc:()=>i});var s=t(48943),r=t(27058),d=t(75033);let l=(0,s.zD)("product/addProduct",async e=>({id:(await (0,r.gS)((0,r.rJ)(d.db,"products"),e)).id,...e})),o=(0,s.zD)("product/fetchProducts",async()=>(await (0,r.GG)((0,r.rJ)(d.db,"products"))).docs.map(e=>({id:e.id,...e.data()}))),i=(0,s.zD)("product/updateProduct",async e=>{let{id:a,newStock:t}=e,s=(0,r.H9)(d.db,"products",a);return await (0,r.mZ)(s,{stock:t}),{id:a,newStock:t}}),n=(0,s.zD)("product/deleteProduct",async e=>(await (0,r.kd)((0,r.H9)(d.db,"products",e)),e)),c=(0,s.zD)("product/totalStock",async()=>{let e=(0,r.rJ)(d.db,"products"),a=await (0,r.GG)(e),t=0;return a.docs.forEach(e=>{t+=e.data().stock||0}),t}),u=(0,s.Z0)({name:"product",initialState:{loading:!1,products:null,error:"",totalProductsInStock:0},reducers:{},extraReducers:e=>{e.addCase(o.pending,e=>{e.loading=!0}),e.addCase(o.fulfilled,(e,a)=>{e.loading=!1,e.products=a.payload}),e.addCase(o.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}),e.addCase(l.fulfilled,(e,a)=>{e.products=e.products?[...e.products,a.payload]:[a.payload]}),e.addCase(i.fulfilled,(e,a)=>{e.products&&(e.products=e.products.map(e=>e.id===a.payload.id?{...e,stock:a.payload.newStock}:e))}),e.addCase(n.fulfilled,(e,a)=>{e.products&&(e.products=e.products.filter(e=>e.id!==a.payload))}),e.addCase(c.fulfilled,(e,a)=>{e.totalProductsInStock=a.payload})}}).reducer},70449:(e,a,t)=>{"use strict";t.d(a,{ReduxProvider:()=>u});var s=t(95155),r=t(83391),d=t(48943),l=t(81654),o=t(94321),i=t(29009),n=t(52587);let c=(0,d.U1)({reducer:{auth:l.Ay,product:o.Ay,sale:i.Ay,impression:n.Ay}});t(12115);let u=e=>{let{children:a}=e;return(0,s.jsx)(r.Kq,{store:c,children:a})}},29009:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>S,FQ:()=>c,Op:()=>p,RA:()=>m,Vf:()=>l,Xg:()=>D,aK:()=>u,cF:()=>g,cP:()=>C,dS:()=>n,h8:()=>f,j3:()=>o,ke:()=>y});var s=t(48943),r=t(27058),d=t(75033);let l=(0,s.zD)("sale/addSale",async e=>{try{let a=await (0,r.gS)((0,r.rJ)(d.db,"sales"),e);console.log("Vente ajout\xe9 avec ID :",a.id)}catch(e){console.error("Erreur lors de l'ajout :",e)}}),o=(0,s.zD)("sale/fetchSales",async()=>{try{let e=(await (0,r.GG)((0,r.rJ)(d.db,"sales"))).docs.map(e=>({id:e.id,...e.data()}));return console.log("ventes r\xe9cup\xe9r\xe9s :",e),e}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration :",e)}}),i=(0,s.zD)("sale/updateSale",async(e,a)=>{try{let t=(0,r.H9)(d.db,"sales",e);await (0,r.mZ)(t,a),console.log("Vente mis \xe0 jour !")}catch(e){console.error("Erreur lors de la mise \xe0 jour :",e)}}),n=(0,s.zD)("sale/deleteSale",async e=>{try{await (0,r.kd)((0,r.H9)(d.db,"sales",e)),console.log("Vente supprim\xe9 !")}catch(e){console.error("Erreur lors de la suppression :",e)}}),c=(0,s.zD)("sale/fetchSalesCountToday",async()=>{let e=new Date,a=e.getUTCFullYear(),t=String(e.getUTCMonth()+1).padStart(2,"0"),s=String(e.getUTCDate()).padStart(2,"0"),l="".concat(a,"-").concat(t,"-").concat(s,"T00:00:00.000Z"),o=(0,r.rJ)(d.db,"sales"),i=(0,r.P)(o,(0,r._M)("date","==",l));return(await (0,r.GG)(i)).docs.length}),u=(0,s.zD)("sale/fetchTotalSalesCount",async()=>{let e=(0,r.rJ)(d.db,"sales");return(await (0,r.GG)(e)).docs.length}),p=(0,s.zD)("sale/amountToday",async()=>{let e=new Date,a=e.getUTCFullYear(),t=String(e.getUTCMonth()+1).padStart(2,"0"),s=String(e.getUTCDate()).padStart(2,"0"),l="".concat(a,"-").concat(t,"-").concat(s,"T00:00:00.000Z"),o=(0,r.rJ)(d.db,"sales"),i=(0,r.P)(o,(0,r._M)("date","==",l)),n=await (0,r.GG)(i),c=0;return n.docs.forEach(e=>{let a=e.data();c+=a.total}),c}),m=(0,s.zD)("sale/totalAmount",async()=>{let e=(0,r.rJ)(d.db,"sales"),a=await (0,r.GG)(e),t=0;return a.docs.forEach(e=>{let a=e.data();t+=a.total}),t}),y=(0,s.zD)("sale/last10",async()=>{let e=(0,r.rJ)(d.db,"sales"),a=(0,r.P)(e,(0,r.My)("date","desc"),(0,r.AB)(10));return(await (0,r.GG)(a)).docs.map(e=>({id:e.id,...e.data()}))}),f=(0,s.zD)("sale/last7Days",async()=>{let e=new Date,a=new Date;a.setDate(e.getDate()-7),a.setHours(0,0,0,0);let t="".concat(a.getUTCFullYear(),"-").concat(String(a.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(a.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z"),s=(0,r.rJ)(d.db,"sales"),l=(0,r.P)(s,(0,r._M)("date",">=",t)),o=await (0,r.GG)(l),i={};for(let a=6;a>=0;a--){let t=new Date;t.setDate(e.getDate()-a),i["".concat(t.getUTCFullYear(),"-").concat(String(t.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(t.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z").split("T")[0]]=0}return o.docs.forEach(e=>{let a=e.data(),t=new Date(a.date),s="".concat(t.getUTCFullYear(),"-").concat(String(t.getUTCMonth()+1).padStart(2,"0"),"-").concat(String(t.getUTCDate()).padStart(2,"0"),"T00:00:00.000Z").split("T")[0];i.hasOwnProperty(s)&&(i[s]+=a.total)}),i}),h=(0,s.zD)("sale/byProduct",async()=>{let e=(0,r.rJ)(d.db,"sales"),a=await (0,r.GG)(e),t={};return a.docs.forEach(e=>{e.data().articles.forEach(e=>{t[e.nom]||(t[e.nom]=0),t[e.nom]+=e.total})}),t}),g=(0,s.zD)("sale/fetchSumDaySales",async e=>{let a=(0,r.rJ)(d.db,"sales"),t=(0,r.P)(a,(0,r._M)("date","==",e)),s=await (0,r.GG)(t),l=0;return s.docs.forEach(e=>{let a=e.data();l+=a.total}),l}),C=(0,s.zD)("sale/fetchNumberDaySales",async e=>{let a=(0,r.rJ)(d.db,"sales"),t=(0,r.P)(a,(0,r._M)("date","==",e));return(await (0,r.GG)(t)).docs.length}),D=(0,s.zD)("sale/fetchAllDaysSales",async e=>{let a=(0,r.rJ)(d.db,"sales"),t=(0,r.P)(a,(0,r._M)("date","==",e));return(await (0,r.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}),S=(0,s.Z0)({name:"sale",initialState:{loading:!1,salesLast7Days:[],sales:null,error:"",salesByProduct:[],salesCountToday:0,totalSalesCount:0,salesAmountToday:0,totalSalesAmount:0,salesAmountTDay:0,nbrSalesDay:0,allDaysSales:[]},reducers:{},extraReducers:e=>{e.addCase(l.pending,e=>{e.loading=!0}).addCase(l.fulfilled,e=>{e.loading=!1}).addCase(l.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(o.pending,e=>{e.loading=!0}).addCase(o.fulfilled,(e,a)=>{e.loading=!1,e.sales=a.payload}).addCase(o.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.loading=!0}).addCase(i.fulfilled,e=>{e.loading=!1}).addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(n.pending,e=>{e.loading=!0}).addCase(n.fulfilled,e=>{e.loading=!1}).addCase(n.rejected,(e,a)=>{e.loading=!1,e.error=a.payload}).addCase(c.fulfilled,(e,a)=>{e.salesCountToday=a.payload}).addCase(u.fulfilled,(e,a)=>{e.totalSalesCount=a.payload}).addCase(p.fulfilled,(e,a)=>{e.salesAmountToday=a.payload}).addCase(m.fulfilled,(e,a)=>{e.totalSalesAmount=a.payload}).addCase(y.fulfilled,(e,a)=>{e.sales=a.payload}).addCase(f.fulfilled,(e,a)=>{e.salesLast7Days=a.payload}).addCase(h.fulfilled,(e,a)=>{e.salesByProduct=a.payload}).addCase(g.fulfilled,(e,a)=>{e.salesAmountTDay=a.payload}).addCase(C.fulfilled,(e,a)=>{e.nbrSalesDay=a.payload}).addCase(D.fulfilled,(e,a)=>{e.allDaysSales=a.payload})}}).reducer},75033:(e,a,t)=>{"use strict";t.d(a,{db:()=>l});var s=t(49904),r=t(27058);let d=(0,s.Wp)({apiKey:"AIzaSyASZSWBGwPJYuQDRi1GObaNtrccuaBfu70",authDomain:"bgmultiservices-781c8.firebaseapp.com",projectId:"bgmultiservices-781c8",messagingSenderId:"749311417727",appId:"1:749311417727:web:3ea8698ba8ac3ac7ac8e4a"}),l=(0,r.aU)(d)},30347:()=>{}},e=>{var a=a=>e(e.s=a);e.O(0,[360,992,876,125,604,441,517,358],()=>a(42640)),_N_E=e.O()}]);